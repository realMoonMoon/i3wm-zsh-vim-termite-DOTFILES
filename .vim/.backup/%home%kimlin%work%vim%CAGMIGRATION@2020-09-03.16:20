### Whitelists
### From CAG to K8S
Whitelist outgoing traffic on port 6443 from CAG to both master and worker nodes at ELX
Whitelist outgoing traffic on port range 30000-32767 from CAG to the worker nodes at ELX, not master.
### Helm repo
Contact Neil Liu for this
### Check ports are open
# Masters 
python -c "import sys; import socket; print(socket.socket(socket.AF_INET, socket.SOCK_STREAM).connect_ex(('212.237.149.105', 6443)))"
# Workers
python -c "import sys; import socket; print(socket.socket(socket.AF_INET, socket.SOCK_STREAM).connect_ex(('212.237.149.176', 30000)))"

### Install kubectl
curl -LO https://storage.googleapis.com/kubernetes-release/release/`curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt`/bin/linux/amd64/kubectl
mv kubectl /usr/bin/
chmod +x /usr/bin/kubectl
### Configure kubectl
copy .kube/config from k8s production
Check status with some command like kubectl get nodes or kubectl cluster-info.

###  Install helm
wget https://get.helm.sh/helm-v3.2.4-linux-amd64.tar.gz
tar zxfv helm-v3.2.4-linux-amd64.tar.gz 
mv linux-amd64/helm /usr/local/bin/
chmod +x /usr/local/bin/helm 
### Configure Helm
mkdir -p .config/helm
helm repo add leandev --username leandev --password l34nd3vHELMR3p0 https://helm.kubernetes.leandev.se
helm repo add leandev-lfp --username gitlab --password '39s5y!#gyd2%pTYR' https://hub.service.leandev.com/chartrepo/lfp/
helm repo add stable https://kubernetes-charts.storage.googleapis.com/
helm repo update

välj resume
installera kube+helm på CAG
kör prepare på cag



git clone git@docker.leandev.se:/docker/leandev/gitrepo/lfp.git
cd lfp
./lfp-tools.sh switch v6.10.0-build.11
./lfp-tools.sh prepare
/data/lfp/./lfp-tools.sh stop
./lfp-tools.sh migrate start -d /data/lfp/



12:49-13:11 cli migrate
13:15 gui migrate
